<!-- settings.html -->
<div id="settingsContainer" class="settings">
    <h1>Settings</h1>
    <div>
        <label for="themeSwitcher">Theme:</label>
        <select id="themeSwitcher">
            <option value="light">Light Mode</option>
            <option value="dark">Dark Mode</option>
        </select>
    </div>
    <div>
        <label for="slideshowInterval">Slideshow Interval (seconds):</label>
        <input type="number" id="slideshowInterval" min="1" value="3">
    </div>
    <div>
        <label for="showHiddenFiles">Show Hidden Files:</label>
        <input type="checkbox" id="showHiddenFiles">
    </div>
    <button id="applySettings">Apply</button>
</div>

<script type="module">
    import { applySettings, initializeTheme } from './static/js/main.js';

    function loadSettings() {
        const showHiddenFilesCheckbox = document.getElementById('showHiddenFiles');
        const themeSwitcher = document.getElementById('themeSwitcher');
        const slideshowInterval = document.getElementById('slideshowInterval');

        showHiddenFilesCheckbox.checked = localStorage.getItem('showHiddenFiles') === 'true';
        themeSwitcher.value = localStorage.getItem('theme') || 'light';
        slideshowInterval.value = localStorage.getItem('slideshowInterval') || '3';

        // Apply the current theme immediately
        initializeTheme();
    }

    function setupEventListeners() {
        const applyButton = document.getElementById('applySettings');
        applyButton.addEventListener('click', () => {
            const theme = document.getElementById('themeSwitcher').value;
            const interval = parseInt(document.getElementById('slideshowInterval').value, 10);
            const showHidden = document.getElementById('showHiddenFiles').checked;
            applySettings(theme, interval, showHidden);
        });
    }

    // Load settings and set up event listeners when the content is loaded
    document.addEventListener('DOMContentLoaded', () => {
        loadSettings();
        setupEventListeners();
    });

    // Also load settings when the settings view is shown
    document.addEventListener('viewChanged', (event) => {
        if (event.detail.view === 'settings') {
            loadSettings();
        }
    });
</script>